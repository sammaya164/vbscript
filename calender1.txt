3:I[4707,[],""]
5:I[6423,[],""]
6:I[76,["185","static/chunks/app/layout-a24cc29d45a5ce04.js"],"ThemeSwitcher"]
4:["slug","calender1","d"]
7:{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"}
8:{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"}
9:{"display":"inline-block"}
a:{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0}
0:["AMkc6tatsjp8p4K3-VcRn",[[["",{"children":["(blog)",{"children":[["slug","calender1","d"],{"children":["__PAGE__?{\"slug\":\"calender1\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["(blog)",{"children":[["slug","calender1","d"],{"children":["__PAGE__",{},[["$L1","$L2",[["$","link","0",{"rel":"stylesheet","href":"/vbscript/_next/static/css/b6dd24d3fdd5bfe9.css","precedence":"next","crossOrigin":"$undefined"}]]],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","(blog)","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/vbscript/_next/static/css/ce90c4206395b4a9.css","precedence":"next","crossOrigin":"$undefined"}]],["$","main",null,{"children":["$","div",null,{"className":"p-1 md:p-8","children":["$","div",null,{"className":"lg:flex py-2","children":[["$","div",null,{"className":"sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5","children":["$","nav",null,{"children":[["$","input",null,{"id":"ac-toc","type":"checkbox","className":"peer/toc hidden"}],["$","label",null,{"htmlFor":"ac-toc","className":"   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[''] after:content-['']   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   ","children":"メニュー"}],["$","div",null,{"className":"hidden lg:block peer-checked/toc:block mt-8 lg:mt-4","children":["$","section",null,{"children":[["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/helloworld","className":"hover:underline","children":"Hello, World!と表示させる"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/msgbox","className":"hover:underline","children":"MsgBox関数"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/inputbox","className":"hover:underline","children":"InputBox関数"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/array","className":"hover:underline","children":"配列(1) 配列の作り方"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/filter","className":"hover:underline","children":"配列(2) 配列の操作"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/fso","className":"hover:underline","children":"FileSystemObjectオブジェクト"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/path","className":"hover:underline","children":"ファイル名、パス名を取得する"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/file","className":"hover:underline","children":"File、Folder、Drive、TextStreamオブジェクト"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/rename","className":"hover:underline","children":"ファイル名の頭に日付を加える"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/filelist","className":"hover:underline","children":"ファイル一覧を取得する"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/mdb1","className":"hover:underline","children":"Access形式データベースへの接続（1）OLEDBプロバイダー"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/mdb2","className":"hover:underline","children":"Access形式データベースへの接続（2）DBファイルとテーブルの追加"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/mdb3","className":"hover:underline","children":"Access形式データベースへの接続（3）列の追加"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/mdb4","className":"hover:underline","children":"Access形式データベースへの接続（4）レコードの登録と削除"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/adox","className":"hover:underline","children":"ADOとADOXのオブジェクト"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/mnist","className":"hover:underline","children":"バイナリファイルを読む"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/class","className":"hover:underline","children":"クラスを自作する"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/calender1","className":"hover:underline","children":"カレンダー計算（1）日付からMJDへの変換"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/calender2","className":"hover:underline","children":"カレンダー計算（2）MJDから日付への変換"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/calender3","className":"hover:underline","children":"カレンダー計算（3）万年カレンダー"}]}]}],["$","div",null,{"children":["$","h3",null,{"className":"text-lg mb-3 leading-snug","children":["$","a",null,{"href":"/vbscript/encoder","className":"hover:underline","children":"VBScriptの暗号化"}]}]}]]}]}]]}]}],["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","(blog)","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]]}]}]}]],null],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/vbscript/_next/static/css/741e77bcaef201b5.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"180x180","href":"/vbscript/favicon/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/vbscript/favicon/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/vbscript/favicon/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/vbscript/favicon/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/vbscript/favicon/safari-pinned-tab.svg","color":"#000000"}],["$","link",null,{"rel":"shortcut icon","href":"/vbscript/favicon/favicon.ico"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"msapplication-config","content":"/vbscript/favicon/browserconfig.xml"}],["$","meta",null,{"name":"theme-color","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/vbscript/feed.xml"}]]}],["$","body",null,{"className":"__className_4eacb2 dark:bg-slate-900 dark:text-slate-400","children":[["$","$L6",null,{}],["$","header",null,{"className":"border-b border-neutral-200 dark:bg-stars","children":["$","div",null,{"className":"container px-8","children":["$","div",null,{"className":"py-16 flex flex-col lg:flex-row items-center","children":[["$","h2",null,{"className":"text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3","children":[["$","a",null,{"href":"/vbscript","className":"hover:underline","children":"VBScriptさんま屋"}],"."]}],["$","h4",null,{"className":"text-center text-lg","children":"VBScriptの個人的なメモです (´・ω・`)"}]]}]}]}],["$","div",null,{"className":"min-h-1/2","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":"$7","children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":"$8","children":"404"}],["$","div",null,{"style":"$9","children":["$","h2",null,{"style":"$a","children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}],["$","footer",null,{"className":"bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800","children":["$","div",null,{"className":"container px-8","children":["$","div",null,{"className":"py-28 flex flex-col lg:flex-row items-center","children":[["$","h3",null,{"className":"text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2","children":"Statically Generated with Next.js."}],["$","div",null,{"className":"flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2","children":[["$","a",null,{"href":"https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates","className":"mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0","children":"Read Documentation"}],["$","a",null,{"href":"https://github.com/sammaya164/vbscript","className":"mx-3 font-bold hover:underline","children":"View on GitHub"}]]}]]}]}]}]]}]]}]],null],null],["$Lb",null]]]]
c:T3539,<nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#概要">概要</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#日付を日数で表す">日付を日数で表す</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#西暦">西暦</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#曜日と日干支の算出方法">曜日と日干支の算出方法</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#ユリウス日修正ユリウス日を計算する">ユリウス日、修正ユリウス日を計算する</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#参考">参考</a></li></ol></nav><h2 id="概要">概要</h2>
<p>天文計算や暦計算で使われる、日付と修正ユリウス日の間の変換方法。<br>
以下のような計算に役立つ。</p>
<ul>
<li>曜日の計算</li>
<li>ユリウス暦とグレゴリオ暦の間の変換</li>
<li>2つの日付間の日数の計算</li>
</ul>
<p>今回は日付から修正ユリウス日への変換方法。</p>
<h2 id="日付を日数で表す">日付を日数で表す</h2>
<p>年月日で表される日付は、年・月・日の軸をもつ3次元空間に並べられた点の集まりと解釈できる。<br>
しかし天文や暦の計算においては、日付は1次元の線上に並べたほうが扱い易くなる。<br>
すなわち、ある特定の日を第0日とし、そこから通算の経過日数で日付を表すという方法である。</p>
<h3 id="ユリウス日ユリウス通日julian-dayjd">ユリウス日、ユリウス通日(Julian Day、JD)</h3>
<ul>
<li>紀元前4713年1月1日正午(ユリウス暦)を第0日としたときの通算の日数で日付を表したもの。</li>
<li>正負の整数であれば正午を表すが、小数部で時刻を表す。</li>
</ul>
<p>2025年1月1日の正午で、2,460,677になる。</p>
<h3 id="修正ユリウス日準ユリウス日modified-julian-daymjd">修正ユリウス日、準ユリウス日(Modified Julian Day、MJD)</h3>
<ul>
<li>ユリウス日よりも小さい桁で日付を扱えるよう考え出された。</li>
<li>ユリウス日から2400000.5日を引いたものとして定義される。</li>
<li>1858年11月17日(グレゴリオ暦)を第0日としたときの通算の日数で日付を表す。</li>
<li>正負の整数であれば午前0時を表すが、小数部で時刻を表す。</li>
</ul>
<p>2025年1月1日の午前0時で60,676になる。</p>
<h2 id="西暦">西暦</h2>
<p>西暦には、うるう年をどのように定めるかによって、ユリウス暦とグレゴリオ暦がある。現在使われているのはグレゴリオ暦。</p>
<h3 id="ユリウス暦">ユリウス暦</h3>
<p>以下のルールがある。</p>
<ol>
<li>うるう年は4年に1回。</li>
</ol>
<p>すなわち、4年は1,461日(=365×3+366)、1年は365.25日(=1,461/4)。実際の1太陽年(地球の公転周期/自転周期)はおよそ365.2422(日)なので、ユリウス暦では1年あたり365.2422-365.25=-0.0078日の誤差が生じる。1600年経てば約12.5日ずれる。</p>
<p>ユリウス暦は紀元前45年にローマで導入された。<br>
当初は4年に1回とすべきうるう年を、3年に1回で誤運用していた。誤りに気づいた後、調整の為うるう年を設けない期間が設けられ、西暦8年のうるう年以降は4年に1回で運用された。<br>
このへんの歴史は考慮せず、後に出てくるプログラムでは、ユリウス暦は単純に4年に1回のうるう年を設けている。</p>
<h3 id="グレゴリオ暦">グレゴリオ暦</h3>
<p>以下のルールがある。</p>
<ol>
<li>うるう年は4年に1回</li>
<li>ただし100年に1回(西暦が100で割り切れる年)はうるう年を取消し。</li>
<li>ただし400年に1回(西暦が400で割り切れる年)はうるう年。</li>
</ol>
<p>すなわち400年のうちうるう年は400/4-4+1=97回あるので、400年は146,097日(=365×303+366×97)、1年は365.2425日(=146,097/400)。グレゴリオ暦では1年あたり365.2422-365.2425=-0.0003日の誤差が生じる。1600年経てば約0.5日ずれる。1万年経っても約3日しかずれない。</p>
<p>グレゴリオ暦は、ユリウス暦1582年10月4日の翌日、グレゴリオ暦1582年10月15日からローマで採用された。<br>
グレゴリオ暦の導入時期は国によって異なり、日本では旧暦明治5年12月2日の翌日、新暦明治6年1月1日から開始された。</p>
<h3 id="紀元前の表現">紀元前の表現</h3>
<p>西暦1年の前年は紀元前1年だが、天文学では年数計算を簡便にする為、紀元前1年を西暦0年、紀元前2年を西暦-1年、・・、紀元前N年を西暦-(N-1)年とする紀年法が使われる。<br>
以下のプログラムもこれに従う。たとえば紀元前4713年は-4712年と表示する。</p>
<h2 id="曜日と日干支の算出方法">曜日と日干支の算出方法</h2>
<h3 id="曜日">曜日</h3>
<p>(修正ユリウス日+3)を7で割った余りから曜日が得られる<br>
(0:日、1:月、2:火、3:水、4:木、5:金、6:土)</p>
<h3 id="日干支">日干支</h3>
<ul>
<li>修正ユリウス日を10で割った余りから十干が得られる<br>
(0:甲、1:乙、2:丙、3:丁、4:戊、5:己、6:庚、7:辛、8:壬、9:癸)</li>
<li>(修正ユリウス日+2)を12で割った余りから十二支が得られる<br>
(0:子、1丑、2:寅、3:卯、4:辰、5:巳、6:午、7:未、8:申、9:酉、10:戌、11:亥)</li>
</ul>
<h2 id="ユリウス日修正ユリウス日を計算する">ユリウス日、修正ユリウス日を計算する</h2>
<p>年月日から修正ユリウス日を算出して表示するプログラム。<br>
曜日と日干支も表示する。</p>
<pre><code class="hljs language-vbs"><span class="hljs-comment">'修正ユリウス日(MJD)を計算する</span>

<span class="hljs-keyword">Dim</span> dt
<span class="hljs-keyword">Dim</span> buf
<span class="hljs-keyword">Dim</span> Y, M ,D
<span class="hljs-keyword">Dim</span> mjd1 <span class="hljs-comment">'グレゴリオ暦の日付から算出したMJD</span>
<span class="hljs-keyword">Dim</span> mjd2 <span class="hljs-comment">'ユリウス暦の日付から算出したMJD</span>
<span class="hljs-keyword">Dim</span> msg  <span class="hljs-comment">'表示するメッセージ</span>

dt = <span class="hljs-built_in">Date</span>() <span class="hljs-comment">'本日をデフォルト値とする</span>

<span class="hljs-keyword">Do</span>
    dt = <span class="hljs-built_in">InputBox</span>(<span class="hljs-string">"日付を入力して下さい"</span>, , dt)
    <span class="hljs-keyword">If</span> dt = <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span> <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Do</span> <span class="hljs-comment">'キャンセルが押されたら終了</span>

    buf = <span class="hljs-built_in">Split</span>(dt, <span class="hljs-string">"/"</span>) <span class="hljs-comment">'年,月,日の配列</span>

    Y = <span class="hljs-built_in">CDbl</span>(buf(<span class="hljs-number">0</span>)) <span class="hljs-comment">'年, 数値へ変換</span>
    M = <span class="hljs-built_in">CDbl</span>(buf(<span class="hljs-number">1</span>)) <span class="hljs-comment">'月, 数値へ変換</span>
    D = <span class="hljs-built_in">CDbl</span>(buf(<span class="hljs-number">2</span>)) <span class="hljs-comment">'日, 数値へ変換</span>
    
    <span class="hljs-comment">'1,2月を前年の13,14月にする</span>
    <span class="hljs-keyword">If</span> M &#x3C; <span class="hljs-number">3</span> <span class="hljs-keyword">Then</span>
        Y = Y - <span class="hljs-number">1</span>
        M = M + <span class="hljs-number">12</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

    <span class="hljs-comment">'グレゴリオ暦の日付から修正ユリウス日を算出</span>
    mjd1 = - <span class="hljs-number">678882</span> + <span class="hljs-number">365</span> * Y + Month<span class="hljs-built_in">Day</span>(M - <span class="hljs-number">1</span>) + D + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">4</span>) _
           - <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">100</span>) + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">400</span>)

    <span class="hljs-comment">'ユリウス暦の日付から修正ユリウス日を算出</span>
    mjd2 = - <span class="hljs-number">678884</span> + <span class="hljs-number">365</span> * Y + Month<span class="hljs-built_in">Day</span>(M - <span class="hljs-number">1</span>) + D + <span class="hljs-built_in">Int</span>(Y / <span class="hljs-number">4</span>)

    <span class="hljs-comment">'表示するメッセージ    </span>
    msg = <span class="hljs-string">"グレゴリオ暦の"</span> &#x26; dt &#x26; <span class="hljs-string">"は"</span> &#x26; vbCr _
        &#x26; <span class="hljs-string">"MJD="</span> &#x26; mjd1 &#x26; <span class="hljs-string">"、"</span> &#x26; GetWeek(mjd1) _
        &#x26; <span class="hljs-string">"、"</span> &#x26; GetEto(mjd1) &#x26; vbCr &#x26; vbCr _
        &#x26; <span class="hljs-string">"ユリウス暦の"</span> &#x26; dt &#x26; <span class="hljs-string">"は"</span> &#x26; vbCr _
        &#x26; <span class="hljs-string">"MJD="</span> &#x26; mjd2 &#x26; <span class="hljs-string">"、"</span> &#x26; GetWeek(mjd2) _
        &#x26; <span class="hljs-string">"、"</span> &#x26; GetEto(mjd2)

    Msgbox msg,, <span class="hljs-string">"修正ユリウス日"</span>
<span class="hljs-keyword">Loop</span>


<span class="hljs-keyword">Function</span> Month<span class="hljs-built_in">Day</span>(M)
<span class="hljs-comment">'2月末日を第0日としてM月末日までの日数を返す(M=2～13)</span>
    MonthDay = <span class="hljs-built_in">Int</span>(<span class="hljs-number">30.59</span> * (M - <span class="hljs-number">1</span>)) - <span class="hljs-number">30</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>


<span class="hljs-keyword">Function</span> GetWeek(mjd)
    <span class="hljs-keyword">Dim</span> p
    p = (mjd + <span class="hljs-number">3</span>) Mod <span class="hljs-number">7</span>
    <span class="hljs-keyword">If</span> p &#x3C; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span> p = p + <span class="hljs-number">7</span>
    GetWeek = <span class="hljs-built_in">Mid</span>(<span class="hljs-string">"日月火水木金土"</span>, p+<span class="hljs-number">1</span>, <span class="hljs-number">1</span>) &#x26; <span class="hljs-string">"曜日"</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>


<span class="hljs-keyword">Function</span> GetEto(mjd)
    <span class="hljs-keyword">Dim</span> p1, p2
    p1 = mjd Mod <span class="hljs-number">10</span>
    <span class="hljs-keyword">If</span> p1 &#x3C; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span> p1 = p1 + <span class="hljs-number">10</span>
    p2 = (mjd + <span class="hljs-number">2</span>) Mod <span class="hljs-number">12</span>
    <span class="hljs-keyword">If</span> p2 &#x3C; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span> p2 = p2 + <span class="hljs-number">12</span>
    GetEto = <span class="hljs-built_in">Mid</span>(<span class="hljs-string">"甲乙丙丁戊己庚辛壬癸"</span>, p1+<span class="hljs-number">1</span>, <span class="hljs-number">1</span>) _
    &#x26; <span class="hljs-built_in">Mid</span>(<span class="hljs-string">"子丑寅卯辰巳午未申酉戌亥"</span>, p2+<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>


<span class="hljs-keyword">Function</span> Month<span class="hljs-built_in">Day</span>(M)
<span class="hljs-comment">'2月末日を第0日としてM月末日までの日数を返す(M=2～13)</span>
    MonthDay = <span class="hljs-built_in">Int</span>(<span class="hljs-number">30.59</span> * (M - <span class="hljs-number">1</span>)) - <span class="hljs-number">30</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>

</code></pre>
<ul>
<li>1,2月を13,14月に変換するのは、計算上2月末日を1年の最終日、もしくは翌年の第0日として扱うため。</li>
<li>計算式に出てくる-678882と-678884は、それぞれグレゴリオ暦とユリウス暦における紀元前1年2月29日のMJD。</li>
</ul>
<h3 id="実行例">実行例</h3>
<p>ダブルクリックして日付を入力すると、ダイアログボックスが表示される。以下は<code>2025/1/1</code>と入力した場合の表示例。</p>
<pre><code class="hljs language-text">グレゴリオ暦の2025/1/1は
MJD=60676、水曜日、庚午

ユリウス暦の2025/1/1は
MJD=60689、火曜日、癸未
</code></pre>
<h2 id="参考">参考</h2>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/%E3%83%A6%E3%83%AA%E3%82%A6%E3%82%B9%E9%80%9A%E6%97%A5">ユリウス通日(Wikipedia)</a></li>
<li>マイコン宇宙講座―楽しい軌道計算プログラム(中野圭一著)</li>
</ul>2:["$","article",null,{"className":"mb-32 pt-6 lg:px-6","children":[[["$","h1",null,{"className":"text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left","children":"カレンダー計算（1）日付からMJDへの変換"}],["$","div",null,{"className":"mb-6 text-lg","children":["$","time",null,{"dateTime":"2024-11-22T00:00:00.000Z","children":"2024/11/22"}]}]],["$","div",null,{"className":"markdown-styles_markdown__ORfR8","dangerouslySetInnerHTML":{"__html":"$c"}}]]}]
b:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"カレンダー計算（1）日付からMJDへの変換 | VBScriptさんま屋"}],["$","meta","3",{"name":"description","content":"VBScriptの個人的なメモです"}],["$","meta","4",{"property":"og:title","content":"カレンダー計算（1）日付からMJDへの変換"}],["$","meta","5",{"property":"og:description","content":"VBScriptの個人的なメモです"}],["$","meta","6",{"property":"og:image","content":"https://www.sammaya.jp/test/assets/img/stars.jpg"}],["$","meta","7",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","8",{"name":"twitter:title","content":"カレンダー計算（1）日付からMJDへの変換"}],["$","meta","9",{"name":"twitter:description","content":"VBScriptの個人的なメモです"}],["$","meta","10",{"name":"twitter:image","content":"https://www.sammaya.jp/test/assets/img/stars.jpg"}]]
1:null
