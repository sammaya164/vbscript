<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/vbscript/_next/static/css/741e77bcaef201b5.css" data-precedence="next"/><link rel="stylesheet" href="/vbscript/_next/static/css/ce90c4206395b4a9.css" data-precedence="next"/><link rel="stylesheet" href="/vbscript/_next/static/css/b6dd24d3fdd5bfe9.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/vbscript/_next/static/chunks/webpack-6154b19b1850f5a1.js"/><script src="/vbscript/_next/static/chunks/fd9d1056-d9c6beefe29fb10d.js" async=""></script><script src="/vbscript/_next/static/chunks/117-234de04a4e857196.js" async=""></script><script src="/vbscript/_next/static/chunks/main-app-b0e285e9e555fa9c.js" async=""></script><script src="/vbscript/_next/static/chunks/app/layout-a24cc29d45a5ce04.js" async=""></script><title>ファイル名、パス名を取得する | VBScript</title><meta name="description" content="ファイル名、パス名を取得する方法,FileSystemObjectのパス関係のメソッド,指定したファイルのファイル名やパスを取得する,BuildPathメソッド"/><meta property="og:title" content="ファイル名、パス名を取得する"/><meta property="og:description" content="ファイル名、パス名を取得する方法,FileSystemObjectのパス関係のメソッド,指定したファイルのファイル名やパスを取得する,BuildPathメソッド"/><meta property="og:image" content="https://www.sammaya.jp/vbscript/assets/img/stars.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="ファイル名、パス名を取得する"/><meta name="twitter:description" content="ファイル名、パス名を取得する方法,FileSystemObjectのパス関係のメソッド,指定したファイルのファイル名やパスを取得する,BuildPathメソッド"/><meta name="twitter:image" content="https://www.sammaya.jp/vbscript/assets/img/stars.jpg"/><link rel="apple-touch-icon" sizes="180x180" href="/vbscript/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/vbscript/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/vbscript/favicon/favicon-16x16.png"/><link rel="manifest" href="/vbscript/favicon/site.webmanifest"/><link rel="mask-icon" href="/vbscript/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/vbscript/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/vbscript/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/vbscript/feed.xml"/><script src="/vbscript/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_4eacb2 dark:bg-slate-900 dark:text-slate-400"><script>(e=>{let[t,n,r]=["system","dark","light"],i=()=>{let e=document.createElement("style");return e.textContent="*,*:after,*:before{transition:none !important;}",document.head.appendChild(e),()=>{getComputedStyle(document.body),setTimeout(()=>document.head.removeChild(e),1)}},a=matchMedia(`(prefers-color-scheme: ${n})`);window.updateDOM=()=>{let o=i(),l=localStorage.getItem(e)??t,s=a.matches?n:r,c=l===t?s:l,u=document.documentElement.classList;c===n?u.add(n):u.remove(n),document.documentElement.setAttribute("data-mode",l),o()},window.updateDOM(),a.addEventListener("change",window.updateDOM)})('nextjs-blog-starter-theme')</script><button class="switch_switch__v3CFJ"></button><header class="border-b border-neutral-200 dark:bg-stars"><div class="container px-8"><div class="py-16 flex flex-col lg:flex-row items-center"><h2 class="text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3"><a href="/vbscript" class="hover:underline">VBScriptさんま屋</a></h2><h4 class="text-center text-lg"></h4></div></div></header><div class="min-h-1/2"><main><div class="p-1 md:p-8"><div class="lg:flex py-2"><div class="sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5"><nav><input id="ac-toc" type="checkbox" class="peer/toc hidden"/><label for="ac-toc" class="   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[&#x27;&#x27;] after:content-[&#x27;&#x27;]   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   ">メニュー</label><div class="hidden lg:block peer-checked/toc:block mt-8 lg:mt-4"><section><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/helloworld" class="hover:underline">Hello, World!と表示させる</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/msgbox" class="hover:underline">MsgBox関数</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/inputbox" class="hover:underline">InputBox関数</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/array" class="hover:underline">配列の作り方</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/filter" class="hover:underline">配列の操作</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/fso" class="hover:underline">FileSystemObjectオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/path" class="hover:underline">ファイル名、パス名を取得する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/file" class="hover:underline">File、Folder、Drive、TextStreamオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/rename" class="hover:underline">ファイル名の頭に日付を加える</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/filelist" class="hover:underline">ファイル一覧を取得する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/mdb1" class="hover:underline">OLEDBプロバイダー</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/mdb2" class="hover:underline">MDBファイルとテーブルの追加</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/mdb3" class="hover:underline">MDBファイル_列の追加</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/mdb4" class="hover:underline">MDBファイル_レコードの登録と削除</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/adox" class="hover:underline">ADOとADOXのオブジェクト</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/mnist" class="hover:underline">バイナリファイルを読む</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/class" class="hover:underline">クラスを自作する</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/calender1" class="hover:underline">日付からMJDへの変換</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/calender2" class="hover:underline">MJDから日付への変換</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/calender3" class="hover:underline">万年カレンダー</a></h3></div><div><h3 class="text-lg mb-3 leading-snug"><a href="/vbscript/encoder" class="hover:underline">VBScriptの暗号化</a></h3></div></section></div></nav></div><article class="mb-32 pt-6 lg:px-6"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left">ファイル名、パス名を取得する</h1><div class="mb-6 text-lg"><time dateTime="2024-11-02T00:00:00.000Z">2024/11/02</time></div><div class="markdown-styles_markdown__ORfR8"><nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#概要">概要</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#filesystemobjectのパス関係のメソッド">FileSystemObjectのパス関係のメソッド</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#指定したファイルのファイル名やパスを取得する">指定したファイルのファイル名やパスを取得する</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#buildpathメソッド">BuildPathメソッド</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#getspecialfolderメソッド">GetSpecialFolderメソッド</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#wshshellオブジェクトのspecialfoldersプロパティ">WshShellオブジェクトのSpecialFoldersプロパティ</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#wshshellオブジェクトのcurrentdirectoryプロパティ">WshShellオブジェクトのCurrentDirectoryプロパティ</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#wscriptオブジェクトのパス関係のプロパティ">WScriptオブジェクトのパス関係のプロパティ</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#getabsolutepathnameメソッドについて">GetAbsolutePathNameメソッドについて</a></li></ol></nav><h2 id="概要">概要</h2>
<p>ファイル名、パス名を取得する方法。</p>
<h2 id="filesystemobjectのパス関係のメソッド">FileSystemObjectのパス関係のメソッド</h2>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>GetAbsolutePathName</td>
<td>フルパスを返す</td>
</tr>
<tr>
<td>GetBaseName</td>
<td>拡張子を除いたファイル名を返す</td>
</tr>
<tr>
<td>GetExtensionName</td>
<td>拡張子を返す</td>
</tr>
<tr>
<td>GetFileName</td>
<td>ファイル名を返す</td>
</tr>
<tr>
<td>GetDriveName</td>
<td>ドライブ名を返す</td>
</tr>
<tr>
<td>GetParentFolderName</td>
<td>親フォルダ名を返す</td>
</tr>
<tr>
<td>BuildPath</td>
<td>文字列をつないでパスを返す</td>
</tr>
<tr>
<td>GetSpecialFolder</td>
<td>特殊フォルダのパスを返す</td>
</tr>
</tbody>
</table>
<h2 id="指定したファイルのファイル名やパスを取得する">指定したファイルのファイル名やパスを取得する</h2>
<p>以下のスクリプトファイルは、テキストファイル<code>test.txt</code>と一緒に<code>C:\Script</code>フォルダ内に置いてあるとする。</p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> fso, path
<span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)

<span class="hljs-comment">'フルパスで指定した場合</span>
path = <span class="hljs-string">"C:¥Script¥test.txt"</span>
Msgbox fso.GetAbsolutePathName(path) <span class="hljs-comment">'C:¥Script¥test.txt</span>
Msgbox fso.GetBaseName(path)         <span class="hljs-comment">'test</span>
Msgbox fso.GetExtensionName(path)    <span class="hljs-comment">'txt</span>
Msgbox fso.GetFileName(path)         <span class="hljs-comment">'test.txt</span>
Msgbox fso.GetDriveName(path)        <span class="hljs-comment">'C:</span>
Msgbox fso.GetParentFolderName(path) <span class="hljs-comment">'C:¥Script</span>

<span class="hljs-comment">'ファイル名で指定した場合</span>
path = <span class="hljs-string">"test.txt"</span>
Msgbox fso.GetAbsolutePathName(path) <span class="hljs-comment">'C:¥Script¥test.txt</span>
Msgbox fso.GetBaseName(path)         <span class="hljs-comment">'test</span>
Msgbox fso.GetExtensionName(path)    <span class="hljs-comment">'txt</span>
Msgbox fso.GetFileName(path)         <span class="hljs-comment">'test.txt</span>
Msgbox fso.GetDriveName(path)        <span class="hljs-comment">'</span>
Msgbox fso.GetParentFolderName(path) <span class="hljs-comment">'</span>

<span class="hljs-comment">'長さ0の文字列で指定した場合</span>
path = <span class="hljs-string">""</span>
Msgbox fso.GetAbsolutePathName(path) <span class="hljs-comment">'C:¥Script</span>
Msgbox fso.GetBaseName(path)         <span class="hljs-comment">'</span>
Msgbox fso.GetExtensionName(path)    <span class="hljs-comment">'</span>
Msgbox fso.GetFileName(path)         <span class="hljs-comment">'</span>
Msgbox fso.GetDriveName(path)        <span class="hljs-comment">'</span>
Msgbox fso.GetParentFolderName(path) <span class="hljs-comment">'</span>

<span class="hljs-comment">'現在の作業フォルダで指定した場合</span>
path = <span class="hljs-string">"."</span>
Msgbox fso.GetAbsolutePathName(path) <span class="hljs-comment">'C:¥Script</span>
Msgbox fso.GetBaseName(path)         <span class="hljs-comment">'</span>
Msgbox fso.GetExtensionName(path)    <span class="hljs-comment">'</span>
Msgbox fso.GetFileName(path)         <span class="hljs-comment">'.</span>
Msgbox fso.GetDriveName(path)        <span class="hljs-comment">'</span>
Msgbox fso.GetParentFolderName(path) <span class="hljs-comment">'</span>

<span class="hljs-comment">'現在の作業フォルダの親フォルダで指定した場合</span>
path = <span class="hljs-string">".."</span>
Msgbox fso.GetAbsolutePathName(path) <span class="hljs-comment">'C:¥</span>
Msgbox fso.GetBaseName(path)         <span class="hljs-comment">'.</span>
Msgbox fso.GetExtensionName(path)    <span class="hljs-comment">'</span>
Msgbox fso.GetFileName(path)         <span class="hljs-comment">'..</span>
Msgbox fso.GetDriveName(path)        <span class="hljs-comment">'</span>
Msgbox fso.GetParentFolderName(path) <span class="hljs-comment">'</span>
</code></pre>
<p>引数のファイルが実在しなくてもエラーは発生せず値は返ってくる。</p>
<h2 id="buildpathメソッド">BuildPathメソッド</h2>
<p>2つの引数を適宜<code>\</code>を補足してつないだパスを返す。</p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> fso
<span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)

Msgbox fso.BuildPath(<span class="hljs-string">"C:\Script"</span>, <span class="hljs-string">"test.txt"</span>)   <span class="hljs-comment">'C:\Script\test.txt</span>
Msgbox fso.BuildPath(<span class="hljs-string">"C:\Script\"</span>, <span class="hljs-string">"test.txt"</span>)  <span class="hljs-comment">'C:\Script\test.txt</span>
Msgbox fso.BuildPath(<span class="hljs-string">"C:\Script"</span>, <span class="hljs-string">"\test.txt"</span>)  <span class="hljs-comment">'C:\Script\test.txt</span>
Msgbox fso.BuildPath(<span class="hljs-string">"C:\Script\"</span>, <span class="hljs-string">"\test.txt"</span>) <span class="hljs-comment">'C:\Script\test.txt</span>
Msgbox fso.BuildPath(<span class="hljs-string">"C:\Script\test.txt"</span>, <span class="hljs-string">"new.txt"</span>) <span class="hljs-comment">'C:\Script\test.txt\new.txt</span>
Msgbox fso.BuildPath(<span class="hljs-string">"C:"</span>, <span class="hljs-string">"test.txt"</span>)          <span class="hljs-comment">'C:test.txt</span>
Msgbox fso.BuildPath(<span class="hljs-string">"C:\"</span>, <span class="hljs-string">"test.txt"</span>)         <span class="hljs-comment">'C:\test.txt</span>
</code></pre>
<p>ただし下から2番目の場合は<code>\</code>を補足してくれない。</p>
<h2 id="getspecialfolderメソッド">GetSpecialFolderメソッド</h2>
<p>特殊フォルダを取得できる。</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Windowsフォルダ</td>
</tr>
<tr>
<td>1</td>
<td>システムフォルダ</td>
</tr>
<tr>
<td>2</td>
<td>Tempフォルダ</td>
</tr>
</tbody>
</table>
<p></p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> fso
<span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)

Msgbox fso.GetSpecialFolder(<span class="hljs-number">0</span>) <span class="hljs-comment">'C:\Windows</span>
Msgbox fso.GetSpecialFolder(<span class="hljs-number">1</span>) <span class="hljs-comment">'C:\Windows\System32</span>
Msgbox fso.GetSpecialFolder(<span class="hljs-number">2</span>) <span class="hljs-comment">'C:\Users\ログインユーザ\AppData\Local\Temp</span>
</code></pre>
<p>上記のGetSpecialFolderメソッドで取得できるのはフォルダオブジェクトだが、Msgboxに渡されるとパス(デフォルトプロパティ)が表示される。</p>
<h2 id="wshshellオブジェクトのspecialfoldersプロパティ">WshShellオブジェクトのSpecialFoldersプロパティ</h2>
<p>SpecialFoldersコレクションを取得し、特殊フォルダのパスを取得できる。</p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> col
<span class="hljs-keyword">Set</span> col = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"WScript.Shell"</span>).SpecialFolders

Msgbox col(<span class="hljs-number">0</span>)                 <span class="hljs-comment">'C:\Users\Public\Desktop</span>
Msgbox col(<span class="hljs-string">"AllUsersDesktop"</span>) <span class="hljs-comment">'C:\Users\Public\Desktop</span>
</code></pre>
<h3 id="取得できるパス一覧">取得できるパス一覧</h3>
<table>
<thead>
<tr>
<th>数値</th>
<th>指定名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>AllUsersDesktop</td>
<td>全ユーザ共通のデスクトップ</td>
</tr>
<tr>
<td>1</td>
<td>AllUsersStartMenu</td>
<td>全ユーザ共通のスタートメニュー</td>
</tr>
<tr>
<td>2</td>
<td>AllUsersPrograms</td>
<td>全ユーザ共通のスタートメニューのプログラムフォルダ</td>
</tr>
<tr>
<td>3</td>
<td>AllUsersStartup</td>
<td>全ユーザ共通のスタートアップフォルダ</td>
</tr>
<tr>
<td>4</td>
<td>Desktop</td>
<td>デスクトップ</td>
</tr>
<tr>
<td>5</td>
<td>AppData</td>
<td>アプリケーションデータ</td>
</tr>
<tr>
<td>6</td>
<td>PrintHood</td>
<td>プリンタ</td>
</tr>
<tr>
<td>7</td>
<td>Templates</td>
<td>テンプレート</td>
</tr>
<tr>
<td>8</td>
<td>Fonts</td>
<td>フォント</td>
</tr>
<tr>
<td>9</td>
<td>NetHood</td>
<td>ネットワーク</td>
</tr>
<tr>
<td>10</td>
<td>Desktop</td>
<td>デスクトップ</td>
</tr>
<tr>
<td>11</td>
<td>StartMenu</td>
<td>スタートメニュー</td>
</tr>
<tr>
<td>12</td>
<td>SendTo</td>
<td>送るフォルダ</td>
</tr>
<tr>
<td>13</td>
<td>Recent</td>
<td>最近使ったファイル</td>
</tr>
<tr>
<td>14</td>
<td>Startup</td>
<td>スタートアップフォルダ</td>
</tr>
<tr>
<td>15</td>
<td>Favorites</td>
<td>お気に入り</td>
</tr>
<tr>
<td>16</td>
<td>MyDocuments</td>
<td>マイドキュメント</td>
</tr>
<tr>
<td>17</td>
<td>Programs</td>
<td>プログラムフォルダ</td>
</tr>
</tbody>
</table>
<h2 id="wshshellオブジェクトのcurrentdirectoryプロパティ">WshShellオブジェクトのCurrentDirectoryプロパティ</h2>
<p>現在の作業フォルダの取得と変更ができる。</p>
<h3 id="使用例">使用例</h3>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> shell
<span class="hljs-keyword">Set</span> shell = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"WScript.Shell"</span>)

<span class="hljs-comment">'取得</span>
Msgbox shell.CurrentDirectory      <span class="hljs-comment">'C:\Script</span>

<span class="hljs-comment">'変更</span>
shell.CurrentDirectory = <span class="hljs-string">"C:\Test"</span>
Msgbox shell.CurrentDirectory      <span class="hljs-comment">'C:\Test</span>
</code></pre>
<p>VBAだと<code>ChDir</code>と<code>ChDrive</code>を使って現在の作業フォルダを変更できるが、ネットワーク上の共有フォルダを指定するには、ネットワークドライブを設定しておく必要があった。<br>
VBAでも上記のやり方で、ネットワーク上の共有フォルダを指定できて、「ファイルを開く」ダイアログボックスの初期に表示されるフォルダを制御できる。</p>
<h2 id="wscriptオブジェクトのパス関係のプロパティ">WScriptオブジェクトのパス関係のプロパティ</h2>
<p>WSHプログラムや実行中のスクリプトのパスを取得できる。</p>
<table>
<thead>
<tr>
<th>プロパティ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td><code>Windows Script Host</code>という文字列</td>
</tr>
<tr>
<td>Path</td>
<td>Windows Script Hostプログラムがある場所</td>
</tr>
<tr>
<td>ScriptName</td>
<td>スクリプトファイルのファイル名</td>
</tr>
<tr>
<td>ScriptFullName</td>
<td>スクリプトファイルのフルパス</td>
</tr>
</tbody>
</table>
<h3 id="使用例-1">使用例</h3>
<pre><code class="hljs language-vbs">Msgbox WScript.Name
Msgbox WScript.Path
Msgbox WScript.ScriptName
Msgbox WScript.ScriptFullName
</code></pre>
<h2 id="getabsolutepathnameメソッドについて">GetAbsolutePathNameメソッドについて</h2>
<p>起動したスクリプトファイルと同じフォルダ内にある<code>test.txt</code>の絶対パスを取得したい場合</p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> fso, buf

<span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)
buf = fso.GetAbsolutePathName(<span class="hljs-string">"test.txt"</span>)
</code></pre>
<p>で取得できるが、フォルダがネットワーク上の共有フォルダである場合は(共有フォルダでなくローカルのシステムフォルダが作業フォルダになってしまうので)うまくいかない。その場合は</p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> fso, buf

<span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)
buf = fso.GetParentFolderName(WScript.ScriptFullName) &#x26; <span class="hljs-string">"\"</span> &#x26; <span class="hljs-string">"test.txt"</span>
</code></pre>
<p>で取得できる。ただし以下のやり方でも取得できる。</p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> fso, buf

<span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)
buf = fso.GetAbsolutePathName(WScript.ScriptFullName &#x26; <span class="hljs-string">"\..\test.txt"</span>)
</code></pre>
<p><code>test.txt</code>がスクリプトファイルの一つ上の階層にある場合も、以下のようにすればよい。</p>
<pre><code class="hljs language-vbs"><span class="hljs-keyword">Dim</span> fso, buf

<span class="hljs-keyword">Set</span> fso = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"Scripting.FileSystemObject"</span>)
buf = fso.GetAbsolutePathName(WScript.ScriptFullName &#x26; <span class="hljs-string">"\..\..\test.txt"</span>)
</code></pre>
<p><code>GetParentFolderName</code>を2重に適用するよりは、こちらのほうが使いやすい。</p></div></article></div></div></main></div><footer class="bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800"><div class="container px-8"><div class="py-28 flex flex-col lg:flex-row items-center"><h3 class="text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2">Statically Generated with Next.js.</h3><div class="flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2"><a href="https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates" class="mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0">Read Documentation</a><a href="https://github.com/sammaya164/vbscript" class="mx-3 font-bold hover:underline">View on GitHub</a></div></div></div></footer><script src="/vbscript/_next/static/chunks/webpack-6154b19b1850f5a1.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/vbscript/_next/static/css/741e77bcaef201b5.css\",\"style\"]\n2:HL[\"/vbscript/_next/static/css/ce90c4206395b4a9.css\",\"style\"]\n3:HL[\"/vbscript/_next/static/css/b6dd24d3fdd5bfe9.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[2846,[],\"\"]\n7:I[4707,[],\"\"]\n9:I[6423,[],\"\"]\na:I[76,[\"185\",\"static/chunks/app/layout-a24cc29d45a5ce04.js\"],\"ThemeSwitcher\"]\n10:I[1060,[],\"\"]\n8:[\"slug\",\"path\",\"d\"]\nb:{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"}\nc:{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"}\nd:{\"display\":\"inline-block\"}\ne:{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0}\n11:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"c7bB9xDLtC8e-nR7iB8QH\",\"assetPrefix\":\"/vbscript\",\"urlParts\":[\"\",\"path\"],\"initialTree\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"path\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"path\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"path\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",\"$L6\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/vbscript/_next/static/css/b6dd24d3fdd5bfe9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/vbscript/_next/static/css/ce90c4206395b4a9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"main\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"p-1 md:p-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"lg:flex py-2\",\"children\":[[\"$\",\"div\",null,{\"className\":\"sidebar overflow-x-visible lg:border-r lg:overflow-y-scroll py-4 min-w-80 lg:w-1/5\",\"children\":[\"$\",\"nav\",null,{\"children\":[[\"$\",\"input\",null,{\"id\":\"ac-toc\",\"type\":\"checkbox\",\"className\":\"peer/toc hidden\"}],[\"$\",\"label\",null,{\"htmlFor\":\"ac-toc\",\"className\":\"   accodiontoc mb-1   relative before:absolute after:absolute    z-10 after:z-11 before:z-12   peer-checked/toc:hover:after:-rotate-90   peer-checked/toc:bg-[#333]   peer-checked/toc:text-white   peer-checked/toc:before:bg-white   peer-checked/toc:after:bg-white   after:duration-300   py-2 pl-4 pr-10    text-xs font-bold   border border-solid rounded   border-white hover:border-[#bdc1c4]   inline-block   text-[#7a8288] hover:text-white   hover:bg-[#333]   before:content-[''] after:content-['']   before:w-2.5 before:h-0.5 after:w-0.5 after:h-2.5   before:right-4 before:top-4 after:right-5  after:top-3   before:bg-[#7a8288] after:bg-[#7a8288]   hover:after:bg-white hover:before:bg-white   lg:hidden   \",\"children\":\"メニュー\"}],[\"$\",\"div\",null,{\"className\":\"hidden lg:block peer-checked/toc:block mt-8 lg:mt-4\",\"children\":[\"$\",\"section\",null,{\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/helloworld\",\"className\":\"hover:underline\",\"children\":\"Hello, World!と表示させる\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/msgbox\",\"className\":\"hover:underline\",\"children\":\"MsgBox関数\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/inputbox\",\"className\":\"hover:underline\",\"children\":\"InputBox関数\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/array\",\"className\":\"hover:underline\",\"children\":\"配列の作り方\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/filter\",\"className\":\"hover:underline\",\"children\":\"配列の操作\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/fso\",\"className\":\"hover:underline\",\"children\":\"FileSystemObjectオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/path\",\"className\":\"hover:underline\",\"children\":\"ファイル名、パス名を取得する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/file\",\"className\":\"hover:underline\",\"children\":\"File、Folder、Drive、TextStreamオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/rename\",\"className\":\"hover:underline\",\"children\":\"ファイル名の頭に日付を加える\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/filelist\",\"className\":\"hover:underline\",\"children\":\"ファイル一覧を取得する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/mdb1\",\"className\":\"hover:underline\",\"children\":\"OLEDBプロバイダー\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/mdb2\",\"className\":\"hover:underline\",\"children\":\"MDBファイルとテーブルの追加\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/mdb3\",\"className\":\"hover:underline\",\"children\":\"MDBファイル_列の追加\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/mdb4\",\"className\":\"hover:underline\",\"children\":\"MDBファイル_レコードの登録と削除\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/adox\",\"className\":\"hover:underline\",\"children\":\"ADOとADOXのオブジェクト\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/mnist\",\"className\":\"hover:underline\",\"children\":\"バイナリファイルを読む\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/class\",\"className\":\"hover:underline\",\"children\":\"クラスを自作する\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/calender1\",\"className\":\"hover:underline\",\"children\":\"日付からMJDへの変換\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/calender2\",\"className\":\"hover:underline\",\"children\":\"MJDから日付への変換\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/calender3\",\"className\":\"hover:underline\",\"children\":\"万年カレンダー\"}]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h3\",null,{\"className\":\"text-lg mb-3 leading-snug\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript/encoder\",\"className\":\"hover:underline\",\"children\":\"VBScriptの暗号化\"}]}]}]]}]}]]}]}],[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]]}]}]}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/vbscript/_next/static/css/741e77bcaef201b5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/vbscript/favicon/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/vbscript/favicon/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/vbscript/favicon/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/vbscript/favicon/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/vbscript/favicon/safari-pinned-tab.svg\",\"color\":\"#000000\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/vbscript/favicon/favicon.ico\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-config\",\"content\":\"/vbscript/favicon/browserconfig.xml\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/vbscript/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_4eacb2 dark:bg-slate-900 dark:text-slate-400\",\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"header\",null,{\"className\":\"border-b border-neutral-200 dark:bg-stars\",\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"py-16 flex flex-col lg:flex-row items-center\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-2xl lg:text-4xl font-bold tracking-tight lg:tracking-tighter leading-tight lg:w-1/3\",\"children\":[\"$\",\"a\",null,{\"href\":\"/vbscript\",\"className\":\"hover:underline\",\"children\":\"VBScriptさんま屋\"}]}],[\"$\",\"h4\",null,{\"className\":\"text-center text-lg\"}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"min-h-1/2\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$b\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$c\",\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":\"$d\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$e\",\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"bg-neutral-50 border-t border-neutral-200 dark:bg-slate-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"container px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"py-28 flex flex-col lg:flex-row items-center\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-4xl lg:text-[2.5rem] font-bold tracking-tighter leading-tight text-center lg:text-left mb-10 lg:mb-0 lg:pr-4 lg:w-1/2\",\"children\":\"Statically Generated with Next.js.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://nextjs.org/docs/app/building-your-application/routing/layouts-and-templates\",\"className\":\"mx-3 bg-black hover:bg-white hover:text-black border border-black text-white font-bold py-3 px-12 lg:px-8 duration-200 transition-colors mb-6 lg:mb-0\",\"children\":\"Read Documentation\"}],[\"$\",\"a\",null,{\"href\":\"https://github.com/sammaya164/vbscript\",\"className\":\"mx-3 font-bold hover:underline\",\"children\":\"View on GitHub\"}]]}]]}]}]}]]}]]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lf\"],\"globalErrorComponent\":\"$10\",\"missingSlots\":\"$W11\"}]\n"])</script><script>self.__next_f.push([1,"12:T3dbb,"])</script><script>self.__next_f.push([1,"\u003cnav class=\"toc\"\u003e\u003col class=\"toc-level toc-level-1\"\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#概要\"\u003e概要\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#filesystemobjectのパス関係のメソッド\"\u003eFileSystemObjectのパス関係のメソッド\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#指定したファイルのファイル名やパスを取得する\"\u003e指定したファイルのファイル名やパスを取得する\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#buildpathメソッド\"\u003eBuildPathメソッド\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#getspecialfolderメソッド\"\u003eGetSpecialFolderメソッド\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#wshshellオブジェクトのspecialfoldersプロパティ\"\u003eWshShellオブジェクトのSpecialFoldersプロパティ\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#wshshellオブジェクトのcurrentdirectoryプロパティ\"\u003eWshShellオブジェクトのCurrentDirectoryプロパティ\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#wscriptオブジェクトのパス関係のプロパティ\"\u003eWScriptオブジェクトのパス関係のプロパティ\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#getabsolutepathnameメソッドについて\"\u003eGetAbsolutePathNameメソッドについて\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/nav\u003e\u003ch2 id=\"概要\"\u003e概要\u003c/h2\u003e\n\u003cp\u003eファイル名、パス名を取得する方法。\u003c/p\u003e\n\u003ch2 id=\"filesystemobjectのパス関係のメソッド\"\u003eFileSystemObjectのパス関係のメソッド\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eメソッド\u003c/th\u003e\n\u003cth\u003e説明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eGetAbsolutePathName\u003c/td\u003e\n\u003ctd\u003eフルパスを返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGetBaseName\u003c/td\u003e\n\u003ctd\u003e拡張子を除いたファイル名を返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGetExtensionName\u003c/td\u003e\n\u003ctd\u003e拡張子を返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGetFileName\u003c/td\u003e\n\u003ctd\u003eファイル名を返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGetDriveName\u003c/td\u003e\n\u003ctd\u003eドライブ名を返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGetParentFolderName\u003c/td\u003e\n\u003ctd\u003e親フォルダ名を返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eBuildPath\u003c/td\u003e\n\u003ctd\u003e文字列をつないでパスを返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGetSpecialFolder\u003c/td\u003e\n\u003ctd\u003e特殊フォルダのパスを返す\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"指定したファイルのファイル名やパスを取得する\"\u003e指定したファイルのファイル名やパスを取得する\u003c/h2\u003e\n\u003cp\u003e以下のスクリプトファイルは、テキストファイル\u003ccode\u003etest.txt\u003c/code\u003eと一緒に\u003ccode\u003eC:\\Script\u003c/code\u003eフォルダ内に置いてあるとする。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso, path\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'フルパスで指定した場合\u003c/span\u003e\r\npath = \u003cspan class=\"hljs-string\"\u003e\"C:¥Script¥test.txt\"\u003c/span\u003e\r\nMsgbox fso.GetAbsolutePathName(path) \u003cspan class=\"hljs-comment\"\u003e'C:¥Script¥test.txt\u003c/span\u003e\r\nMsgbox fso.GetBaseName(path)         \u003cspan class=\"hljs-comment\"\u003e'test\u003c/span\u003e\r\nMsgbox fso.GetExtensionName(path)    \u003cspan class=\"hljs-comment\"\u003e'txt\u003c/span\u003e\r\nMsgbox fso.GetFileName(path)         \u003cspan class=\"hljs-comment\"\u003e'test.txt\u003c/span\u003e\r\nMsgbox fso.GetDriveName(path)        \u003cspan class=\"hljs-comment\"\u003e'C:\u003c/span\u003e\r\nMsgbox fso.GetParentFolderName(path) \u003cspan class=\"hljs-comment\"\u003e'C:¥Script\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'ファイル名で指定した場合\u003c/span\u003e\r\npath = \u003cspan class=\"hljs-string\"\u003e\"test.txt\"\u003c/span\u003e\r\nMsgbox fso.GetAbsolutePathName(path) \u003cspan class=\"hljs-comment\"\u003e'C:¥Script¥test.txt\u003c/span\u003e\r\nMsgbox fso.GetBaseName(path)         \u003cspan class=\"hljs-comment\"\u003e'test\u003c/span\u003e\r\nMsgbox fso.GetExtensionName(path)    \u003cspan class=\"hljs-comment\"\u003e'txt\u003c/span\u003e\r\nMsgbox fso.GetFileName(path)         \u003cspan class=\"hljs-comment\"\u003e'test.txt\u003c/span\u003e\r\nMsgbox fso.GetDriveName(path)        \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetParentFolderName(path) \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'長さ0の文字列で指定した場合\u003c/span\u003e\r\npath = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\nMsgbox fso.GetAbsolutePathName(path) \u003cspan class=\"hljs-comment\"\u003e'C:¥Script\u003c/span\u003e\r\nMsgbox fso.GetBaseName(path)         \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetExtensionName(path)    \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetFileName(path)         \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetDriveName(path)        \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetParentFolderName(path) \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'現在の作業フォルダで指定した場合\u003c/span\u003e\r\npath = \u003cspan class=\"hljs-string\"\u003e\".\"\u003c/span\u003e\r\nMsgbox fso.GetAbsolutePathName(path) \u003cspan class=\"hljs-comment\"\u003e'C:¥Script\u003c/span\u003e\r\nMsgbox fso.GetBaseName(path)         \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetExtensionName(path)    \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetFileName(path)         \u003cspan class=\"hljs-comment\"\u003e'.\u003c/span\u003e\r\nMsgbox fso.GetDriveName(path)        \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetParentFolderName(path) \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'現在の作業フォルダの親フォルダで指定した場合\u003c/span\u003e\r\npath = \u003cspan class=\"hljs-string\"\u003e\"..\"\u003c/span\u003e\r\nMsgbox fso.GetAbsolutePathName(path) \u003cspan class=\"hljs-comment\"\u003e'C:¥\u003c/span\u003e\r\nMsgbox fso.GetBaseName(path)         \u003cspan class=\"hljs-comment\"\u003e'.\u003c/span\u003e\r\nMsgbox fso.GetExtensionName(path)    \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetFileName(path)         \u003cspan class=\"hljs-comment\"\u003e'..\u003c/span\u003e\r\nMsgbox fso.GetDriveName(path)        \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\r\nMsgbox fso.GetParentFolderName(path) \u003cspan class=\"hljs-comment\"\u003e'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e引数のファイルが実在しなくてもエラーは発生せず値は返ってくる。\u003c/p\u003e\n\u003ch2 id=\"buildpathメソッド\"\u003eBuildPathメソッド\u003c/h2\u003e\n\u003cp\u003e2つの引数を適宜\u003ccode\u003e\\\u003c/code\u003eを補足してつないだパスを返す。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\n\r\nMsgbox fso.BuildPath(\u003cspan class=\"hljs-string\"\u003e\"C:\\Script\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"test.txt\"\u003c/span\u003e)   \u003cspan class=\"hljs-comment\"\u003e'C:\\Script\\test.txt\u003c/span\u003e\r\nMsgbox fso.BuildPath(\u003cspan class=\"hljs-string\"\u003e\"C:\\Script\\\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"test.txt\"\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e'C:\\Script\\test.txt\u003c/span\u003e\r\nMsgbox fso.BuildPath(\u003cspan class=\"hljs-string\"\u003e\"C:\\Script\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"\\test.txt\"\u003c/span\u003e)  \u003cspan class=\"hljs-comment\"\u003e'C:\\Script\\test.txt\u003c/span\u003e\r\nMsgbox fso.BuildPath(\u003cspan class=\"hljs-string\"\u003e\"C:\\Script\\\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"\\test.txt\"\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'C:\\Script\\test.txt\u003c/span\u003e\r\nMsgbox fso.BuildPath(\u003cspan class=\"hljs-string\"\u003e\"C:\\Script\\test.txt\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"new.txt\"\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'C:\\Script\\test.txt\\new.txt\u003c/span\u003e\r\nMsgbox fso.BuildPath(\u003cspan class=\"hljs-string\"\u003e\"C:\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"test.txt\"\u003c/span\u003e)          \u003cspan class=\"hljs-comment\"\u003e'C:test.txt\u003c/span\u003e\r\nMsgbox fso.BuildPath(\u003cspan class=\"hljs-string\"\u003e\"C:\\\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"test.txt\"\u003c/span\u003e)         \u003cspan class=\"hljs-comment\"\u003e'C:\\test.txt\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eただし下から2番目の場合は\u003ccode\u003e\\\u003c/code\u003eを補足してくれない。\u003c/p\u003e\n\u003ch2 id=\"getspecialfolderメソッド\"\u003eGetSpecialFolderメソッド\u003c/h2\u003e\n\u003cp\u003e特殊フォルダを取得できる。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e引数\u003c/th\u003e\n\u003cth\u003e説明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e0\u003c/td\u003e\n\u003ctd\u003eWindowsフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eシステムフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eTempフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\n\r\nMsgbox fso.GetSpecialFolder(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'C:\\Windows\u003c/span\u003e\r\nMsgbox fso.GetSpecialFolder(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'C:\\Windows\\System32\u003c/span\u003e\r\nMsgbox fso.GetSpecialFolder(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'C:\\Users\\ログインユーザ\\AppData\\Local\\Temp\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上記のGetSpecialFolderメソッドで取得できるのはフォルダオブジェクトだが、Msgboxに渡されるとパス(デフォルトプロパティ)が表示される。\u003c/p\u003e\n\u003ch2 id=\"wshshellオブジェクトのspecialfoldersプロパティ\"\u003eWshShellオブジェクトのSpecialFoldersプロパティ\u003c/h2\u003e\n\u003cp\u003eSpecialFoldersコレクションを取得し、特殊フォルダのパスを取得できる。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e col\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e col = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"WScript.Shell\"\u003c/span\u003e).SpecialFolders\r\n\r\nMsgbox col(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)                 \u003cspan class=\"hljs-comment\"\u003e'C:\\Users\\Public\\Desktop\u003c/span\u003e\r\nMsgbox col(\u003cspan class=\"hljs-string\"\u003e\"AllUsersDesktop\"\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e'C:\\Users\\Public\\Desktop\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"取得できるパス一覧\"\u003e取得できるパス一覧\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e数値\u003c/th\u003e\n\u003cth\u003e指定名\u003c/th\u003e\n\u003cth\u003e説明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e0\u003c/td\u003e\n\u003ctd\u003eAllUsersDesktop\u003c/td\u003e\n\u003ctd\u003e全ユーザ共通のデスクトップ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eAllUsersStartMenu\u003c/td\u003e\n\u003ctd\u003e全ユーザ共通のスタートメニュー\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eAllUsersPrograms\u003c/td\u003e\n\u003ctd\u003e全ユーザ共通のスタートメニューのプログラムフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003eAllUsersStartup\u003c/td\u003e\n\u003ctd\u003e全ユーザ共通のスタートアップフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003eDesktop\u003c/td\u003e\n\u003ctd\u003eデスクトップ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003eAppData\u003c/td\u003e\n\u003ctd\u003eアプリケーションデータ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003ePrintHood\u003c/td\u003e\n\u003ctd\u003eプリンタ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003eTemplates\u003c/td\u003e\n\u003ctd\u003eテンプレート\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003eFonts\u003c/td\u003e\n\u003ctd\u003eフォント\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003eNetHood\u003c/td\u003e\n\u003ctd\u003eネットワーク\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003eDesktop\u003c/td\u003e\n\u003ctd\u003eデスクトップ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003eStartMenu\u003c/td\u003e\n\u003ctd\u003eスタートメニュー\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003eSendTo\u003c/td\u003e\n\u003ctd\u003e送るフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003eRecent\u003c/td\u003e\n\u003ctd\u003e最近使ったファイル\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003eStartup\u003c/td\u003e\n\u003ctd\u003eスタートアップフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e15\u003c/td\u003e\n\u003ctd\u003eFavorites\u003c/td\u003e\n\u003ctd\u003eお気に入り\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003eMyDocuments\u003c/td\u003e\n\u003ctd\u003eマイドキュメント\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e17\u003c/td\u003e\n\u003ctd\u003ePrograms\u003c/td\u003e\n\u003ctd\u003eプログラムフォルダ\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"wshshellオブジェクトのcurrentdirectoryプロパティ\"\u003eWshShellオブジェクトのCurrentDirectoryプロパティ\u003c/h2\u003e\n\u003cp\u003e現在の作業フォルダの取得と変更ができる。\u003c/p\u003e\n\u003ch3 id=\"使用例\"\u003e使用例\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e shell\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e shell = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"WScript.Shell\"\u003c/span\u003e)\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'取得\u003c/span\u003e\r\nMsgbox shell.CurrentDirectory      \u003cspan class=\"hljs-comment\"\u003e'C:\\Script\u003c/span\u003e\r\n\r\n\u003cspan class=\"hljs-comment\"\u003e'変更\u003c/span\u003e\r\nshell.CurrentDirectory = \u003cspan class=\"hljs-string\"\u003e\"C:\\Test\"\u003c/span\u003e\r\nMsgbox shell.CurrentDirectory      \u003cspan class=\"hljs-comment\"\u003e'C:\\Test\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eVBAだと\u003ccode\u003eChDir\u003c/code\u003eと\u003ccode\u003eChDrive\u003c/code\u003eを使って現在の作業フォルダを変更できるが、ネットワーク上の共有フォルダを指定するには、ネットワークドライブを設定しておく必要があった。\u003cbr\u003e\nVBAでも上記のやり方で、ネットワーク上の共有フォルダを指定できて、「ファイルを開く」ダイアログボックスの初期に表示されるフォルダを制御できる。\u003c/p\u003e\n\u003ch2 id=\"wscriptオブジェクトのパス関係のプロパティ\"\u003eWScriptオブジェクトのパス関係のプロパティ\u003c/h2\u003e\n\u003cp\u003eWSHプログラムや実行中のスクリプトのパスを取得できる。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eプロパティ\u003c/th\u003e\n\u003cth\u003e説明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eName\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eWindows Script Host\u003c/code\u003eという文字列\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePath\u003c/td\u003e\n\u003ctd\u003eWindows Script Hostプログラムがある場所\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eScriptName\u003c/td\u003e\n\u003ctd\u003eスクリプトファイルのファイル名\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eScriptFullName\u003c/td\u003e\n\u003ctd\u003eスクリプトファイルのフルパス\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"使用例-1\"\u003e使用例\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003eMsgbox WScript.Name\r\nMsgbox WScript.Path\r\nMsgbox WScript.ScriptName\r\nMsgbox WScript.ScriptFullName\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"getabsolutepathnameメソッドについて\"\u003eGetAbsolutePathNameメソッドについて\u003c/h2\u003e\n\u003cp\u003e起動したスクリプトファイルと同じフォルダ内にある\u003ccode\u003etest.txt\u003c/code\u003eの絶対パスを取得したい場合\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso, buf\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\nbuf = fso.GetAbsolutePathName(\u003cspan class=\"hljs-string\"\u003e\"test.txt\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eで取得できるが、フォルダがネットワーク上の共有フォルダである場合は(共有フォルダでなくローカルのシステムフォルダが作業フォルダになってしまうので)うまくいかない。その場合は\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso, buf\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\nbuf = fso.GetParentFolderName(WScript.ScriptFullName) \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\"\\\"\u003c/span\u003e \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\"test.txt\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eで取得できる。ただし以下のやり方でも取得できる。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso, buf\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\nbuf = fso.GetAbsolutePathName(WScript.ScriptFullName \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\"\\..\\test.txt\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003etest.txt\u003c/code\u003eがスクリプトファイルの一つ上の階層にある場合も、以下のようにすればよい。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbs\"\u003e\u003cspan class=\"hljs-keyword\"\u003eDim\u003c/span\u003e fso, buf\r\n\r\n\u003cspan class=\"hljs-keyword\"\u003eSet\u003c/span\u003e fso = \u003cspan class=\"hljs-built_in\"\u003eCreateObject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Scripting.FileSystemObject\"\u003c/span\u003e)\r\nbuf = fso.GetAbsolutePathName(WScript.ScriptFullName \u0026#x26; \u003cspan class=\"hljs-string\"\u003e\"\\..\\..\\test.txt\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eGetParentFolderName\u003c/code\u003eを2重に適用するよりは、こちらのほうが使いやすい。\u003c/p\u003e"])</script><script>self.__next_f.push([1,"6:[\"$\",\"article\",null,{\"className\":\"mb-32 pt-6 lg:px-6\",\"children\":[[[\"$\",\"h1\",null,{\"className\":\"text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-left\",\"children\":\"ファイル名、パス名を取得する\"}],[\"$\",\"div\",null,{\"className\":\"mb-6 text-lg\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2024-11-02T00:00:00.000Z\",\"children\":\"2024/11/02\"}]}]],[\"$\",\"div\",null,{\"className\":\"markdown-styles_markdown__ORfR8\",\"dangerouslySetInnerHTML\":{\"__html\":\"$12\"}}]]}]\nf:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"ファイル名、パス名を取得する | VBScript\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"ファイル名、パス名を取得する方法,FileSystemObjectのパス関係のメソッド,指定したファイルのファイル名やパスを取得する,BuildPathメソッド\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"ファイル名、パス名を取得する\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"ファイル名、パス名を取得する方法,FileSystemObjectのパス関係のメソッド,指定したファイルのファイル名やパスを取得する,BuildPathメソッド\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image\",\"content\":\"https://www.sammaya.jp/vbscript/assets/img/stars.jpg\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"ファイル名、パス名を取得する\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"ファイル名、パス名を取得する方法,FileSystemObjectのパス関係のメソッド,指定したファイルのファイル名やパスを取得する,BuildPathメソッド\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:image\",\"content\":\"https://www.sammaya.jp/vbscript/assets/img/stars.jpg\"}]]\n5:null\n"])</script></body></html>